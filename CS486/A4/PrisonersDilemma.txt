In the long term, when all the players want to maximize their utility, the best way is to co-operate with others to reach the Nash-equilibrium. So, my agent will play cooperating in the beginning. The base case is when the length of history is 0. It will return 0 as a nice player. When not in the base case, my agent will act based on the opponents' history like following:
First, we collect most 10 recent games history records for opponent1 & opponent2 (if # of games less than 10, we take all), and based on that records, we calculate the average probability of defect based on these 10 games. Let's say if a player plays 3 defect & 7 cooperating, the probability of defect will be 0.3. And I recalculated this probability with the noisy factor, which means all these 10 result could be affected by the noisy factor, so recalculate this by: (3*0.98)+(7*0.02)/10 = 0.308. This will be the actual probability for him to play defect based on the history. Find the max probability of defect among those 2 opponents. And I count the maximum probability as their next move, so it will be 30.8% they going to play defect and 69.2% they going to play cooperating. So I random a number based on the probability of defect, if the number < probability of defect, return 1 as play defect, otherwise return 0, play cooperating.

The reason I think why this would work is that: My agent is kind like the mutation of TfT. Where TfT only read last action made by opponents, instead, I read 10. As the human behaviour, the way we measure how good this person is is that we see what they did recently. I didn't use the entire history is because people might change. We want to forgive or distrust them once they turn good/bad recently. Based on the research online, I found out that without noisy factor, TfT is optimal. TfT is not optimal with the noisy factor since once a player play cooperating and affect by the noisy factor, all the player could be stuck into Dominant-strategy(all play defect) which will lead to a worse outcome other than Nash-equilibrium. Overall, my agent monitors most 10 recent actions took by opponents, and based on these actions, I choose what I going to do in the next round. If they seem like to play cooperating, sure we all play cooperating. Otherwise, let's play defect.
